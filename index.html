<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Virexa Studio</title>

<meta name="google-adsense-account" content="ca-pub-2665946978630569">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2665946978630569" crossorigin="anonymous"></script>

<style>
body{margin:0;font-family:Arial;background:#0b1220;color:white}
header{display:flex;justify-content:space-between;align-items:center;padding:15px 30px;background:#0f172a}
.logo{font-size:22px;color:#00ffd5;font-weight:bold}
nav button{margin-left:10px;padding:8px 14px;border:none;border-radius:8px;background:#00ffd5;color:black;cursor:pointer}
.search{text-align:center;padding:20px}
.search input{width:60%;padding:10px;border-radius:8px;border:none}
.gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:15px;padding:20px}
.gallery img,.gallery video{width:100%;border-radius:12px;cursor:pointer}
.preview{display:none;position:fixed;inset:0;background:#000c;align-items:center;justify-content:center;flex-direction:column;z-index:1000}
.preview img,.preview video{max-width:90%;max-height:70vh;border-radius:20px}
.preview button{margin:8px;padding:10px 20px;border:none;border-radius:10px;background:#00ffd5;color:black;font-weight:bold}
#editor{display:none;position:fixed;inset:0;background:#000;z-index:2000;color:white}
canvas{background:#111;border-radius:12px}
.tools button,.tools select,.tools input{margin:5px;padding:8px;border-radius:6px;border:none}
#layers div{background:#222;margin:4px;padding:6px;border-radius:6px;cursor:pointer}
</style>
</head>

<body>

<header>
<div class="logo">Virexa Studio</div>
<nav>
<button onclick="loadImages()">Wallpapers</button>
<button onclick="loadVideos()">Videos</button>
</nav>
</header>

<div class="search">
<input id="searchBox" placeholder="Search anything...">
<button onclick="search()">Search</button>
</div>

<div class="gallery" id="gallery"></div>

<!-- PREVIEW -->
<div class="preview" id="preview">
<div id="prevHolder"></div>
<button onclick="downloadFile()">‚¨á Download</button>
<button onclick="openEditor()">üé® Edit</button>
<button onclick="closePreview()">Close</button>
</div>

<!-- EDITOR -->
<div id="editor">
<div style="display:flex;height:100%">
<div style="flex:4;display:flex;flex-direction:column;align-items:center;justify-content:center">
<canvas id="canvas" width="900" height="500"></canvas>

<div class="tools">
<button onclick="addText()">Text</button>
<button onclick="addSticker('üî•')">üî•</button>
<button onclick="addSticker('‚≠ê')">‚≠ê</button>
<input type="color" id="colorPicker" value="#00ffd5">
<select id="fontSelect">
<option>Arial</option>
<option>Impact</option>
<option>Georgia</option>
<option>Verdana</option>
<option>Courier New</option>
</select>
<button onclick="undo()">Undo</button>
<button onclick="redo()">Redo</button>
<button onclick="downloadEdited()">Download</button>
<button onclick="closeEditor()">Close</button>
</div>
</div>

<div style="flex:1;background:#111;padding:10px;overflow:auto">
<h3>Layers</h3>
<div id="layers"></div>
</div>
</div>
</div>

<script>
const API_KEY="vyynP2WUKfkwPr0BvwJcgRAMxSTkxZ9ZEhdiWBp5q17g2MxAtw4Qlsnx";
let currentUrl="",isVideo=false;

/* LOAD IMAGES */
function loadImages(q="wallpaper"){
isVideo=false;
fetch(`https://api.pexels.com/v1/search?query=${q}&per_page=30`,{headers:{Authorization:API_KEY}})
.then(r=>r.json()).then(d=>{
gallery.innerHTML="";
d.photos.forEach(p=>{
let img=document.createElement("img");
img.src=p.src.large;
img.onclick=()=>openPreview(p.src.original,false);
gallery.appendChild(img);
});
});
}

/* LOAD VIDEOS */
function loadVideos(q="nature"){
isVideo=true;
fetch(`https://api.pexels.com/videos/search?query=${q}&per_page=20`,{headers:{Authorization:API_KEY}})
.then(r=>r.json()).then(d=>{
gallery.innerHTML="";
d.videos.forEach(v=>{
let vid=document.createElement("video");
vid.src=v.video_files[0].link;
vid.controls=true;
vid.onclick=()=>openPreview(v.video_files[0].link,true);
gallery.appendChild(vid);
});
});
}

function search(){
let q=searchBox.value.trim();
isVideo?loadVideos(q):loadImages(q);
}

/* PREVIEW */
function openPreview(url,video){
currentUrl=url;isVideo=video;
preview.style.display="flex";
prevHolder.innerHTML= video?`<video src="${url}" controls></video>`:`<img src="${url}">`;
}
function closePreview(){preview.style.display="none";}

/* DOWNLOAD */
async function downloadFile(){
const r=await fetch(currentUrl);
const blob=await r.blob();
const a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="virexa-file";
a.click();
}

/* ====== CANVA EDITOR ====== */
let canvas=document.getElementById("canvas");
let ctx=canvas.getContext("2d");
let elements=[],history=[],redoStack=[],selected=null;

function saveState(){history.push(JSON.stringify(elements));redoStack=[];}

function render(){
ctx.clearRect(0,0,900,500);
elements.forEach(el=>{
if(el.type==="image") ctx.drawImage(el.img,el.x,el.y,el.w,el.h);
else{
ctx.fillStyle=el.color;
ctx.font=`${el.size}px ${el.font}`;
ctx.fillText(el.text,el.x,el.y);
}
});
updateLayers();
}

function updateLayers(){
layers.innerHTML="";
elements.forEach((e,i)=>{
let d=document.createElement("div");
d.textContent=e.type+" "+(i+1);
d.onclick=()=>selected=i;
layers.appendChild(d);
});
}

function openEditor(){
if(isVideo){alert("Edit thumbnails only");return;}
editor.style.display="block";
let img=new Image();
img.crossOrigin="anonymous";
img.onload=()=>{
elements=[{type:"image",img:img,x:0,y:0,w:900,h:500}];
saveState();render();
};
img.src=currentUrl;
}

function closeEditor(){editor.style.display="none";}

function addText(){
let t=prompt("Text");
if(!t)return;
saveState();
elements.push({type:"text",text:t,x:100,y:100,size:40,font:fontSelect.value,color:colorPicker.value});
render();
}

function addSticker(s){
saveState();
elements.push({type:"text",text:s,x:150,y:150,size:70,font:"Arial",color:colorPicker.value});
render();
}

canvas.onmousedown=e=>{
selected=elements.findIndex(el=>e.offsetX>el.x-50&&e.offsetX<el.x+150&&e.offsetY>el.y-50&&e.offsetY<el.y+50);
};
canvas.onmousemove=e=>{
if(selected==null)return;
elements[selected].x=e.offsetX;
elements[selected].y=e.offsetY;
render();
};
canvas.onmouseup=()=>selected=null;

function undo(){
if(history.length<2)return;
redoStack.push(history.pop());
elements=JSON.parse(history[history.length-1]);
render();
}
function redo(){
if(!redoStack.length)return;
let s=redoStack.pop();
history.push(s);
elements=JSON.parse(s);
render();
}

function downloadEdited(){
let a=document.createElement("a");
a.href=canvas.toDataURL();
a.download="virexa-design.png";
a.click();
}

/* INIT */
loadImages();
</script>

</body>
</html>
